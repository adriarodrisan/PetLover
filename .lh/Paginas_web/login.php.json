{
    "sourceFile": "Paginas_web/login.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 15,
            "patches": [
                {
                    "date": 1741794668563,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1741794679958,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,5 +3,6 @@\n include('conexion.php');\r\n \r\n if (!$conn) {\r\n     die(\"Error de conexión: \" . mysqli_connect_error());\r\n+}\r\n ?>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1741794729680,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,7 +2,7 @@\n session_start();\r\n include('conexion.php');\r\n \r\n if (!$conn) {\r\n-    die(\"Error de conexión: \" . mysqli_connect_error());\r\n+    die(\"Conexion fallida: \" . mysqli_connect_error());\r\n }\r\n ?>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1741794761516,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,5 +4,12 @@\n \r\n if (!$conn) {\r\n     die(\"Conexion fallida: \" . mysqli_connect_error());\r\n }\r\n+$correo = trim($_POST['correo']);\r\n+$contrasena = trim($_POST['contrasena']);\r\n+\r\n+if (empty($correo) || empty($contrasena)) {\r\n+    echo \"Por favor completa todos los campos.\";\r\n+    exit;\r\n+}\r\n ?>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1741794823182,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,18 @@\n+<?php\r\n+session_start();\r\n+include('conexion.php');\r\n+\r\n+if (!$conn) {\r\n+    die(\"Conexion fallida: \" . mysqli_connect_error());\r\n+}\r\n+$correo = trim($_POST['correo']);\r\n+$contrasena = trim($_POST['contrasena']);\r\n+\r\n+if (empty($correo) || empty($contrasena)) {\r\n+    echo \"Por favor completa todos los campos.\";\r\n+    exit;\r\n+}\r\n+$sql_adoptante = \"SELECT * FROM adoptante WHERE Correo = '$correo'\";\r\n+$resultado_adoptante = mysqli_query($conn, $sql_adoptante);\r\n+\r\n+?>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1741794852250,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,21 @@\n+<?php\r\n+session_start();\r\n+include('conexion.php');\r\n+\r\n+if (!$conn) {\r\n+    die(\"Conexion fallida: \" . mysqli_connect_error());\r\n+}\r\n+$correo = trim($_POST['correo']);\r\n+$contrasena = trim($_POST['contrasena']);\r\n+\r\n+if (empty($correo) || empty($contrasena)) {\r\n+    echo \"Por favor completa todos los campos.\";\r\n+    exit;\r\n+}\r\n+$sql_adoptante = \"SELECT * FROM adoptante WHERE Correo = '$correo'\";\r\n+$resultado_adoptante = mysqli_query($conn, $sql_adoptante);\r\n+\r\n+if (mysqli_num_rows($resultado_adoptante) > 0) {\r\n+    $fila = mysqli_fetch_assoc($resultado_adoptante);\r\n+}\r\n+?>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1741794936422,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,6 +16,12 @@\n $resultado_adoptante = mysqli_query($conn, $sql_adoptante);\r\n \r\n if (mysqli_num_rows($resultado_adoptante) > 0) {\r\n     $fila = mysqli_fetch_assoc($resultado_adoptante);\r\n+\r\n+    if (password_verify($contrasena, $fila['Contraseña'])) {\r\n+        $_SESSION['usuario'] = $fila['Nombre'];\r\n+        $_SESSION['rol'] = 'refugio';\r\n+        header(\"Location: Home_Petlover.html\");\r\n+        exit;\r\n }\r\n ?>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1741795008633,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,33 @@\n+<?php\r\n+session_start();\r\n+include('conexion.php');\r\n+\r\n+if (!$conn) {\r\n+    die(\"Conexion fallida: \" . mysqli_connect_error());\r\n+}\r\n+$correo = trim($_POST['correo']);\r\n+$contrasena = trim($_POST['contrasena']);\r\n+\r\n+if (empty($correo) || empty($contrasena)) {\r\n+    echo \"Por favor completa todos los campos.\";\r\n+    exit;\r\n+}\r\n+$sql_adoptante = \"SELECT * FROM adoptante WHERE Correo = '$correo'\";\r\n+$resultado_adoptante = mysqli_query($conn, $sql_adoptante);\r\n+\r\n+if (mysqli_num_rows($resultado_adoptante) > 0) {\r\n+    $fila = mysqli_fetch_assoc($resultado_adoptante);\r\n+\r\n+    if (password_verify($contrasena, $fila['Contraseña'])) {\r\n+        $_SESSION['usuario'] = $fila['Nombre'];\r\n+        $_SESSION['rol'] = 'refugio';\r\n+        header(\"Location: Home_Petlover.html\");\r\n+        exit;\r\n+    } else {\r\n+        echo \"Contraseña incorrecta.\";\r\n+        exit;\r\n+    }\r\n+}\r\n+\r\n+echo \"Correo no encontrado.\";\r\n+?>\r\n"
                },
                {
                    "date": 1741876075451,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,32 @@\n+<?php\r\n+session_start();\r\n+include('conexion.php');\r\n+\r\n+if (!$conn) {\r\n+    die(\"Conexion fallida: \" . mysqli_connect_error());\r\n+}\r\n+$correo = trim($_POST['email']);\r\n+$contrasena = trim($_POST['password']);\r\n+\r\n+if (empty($correo) || empty($contrasena)) {\r\n+    echo \"Por favor completa todos los campos.\";\r\n+    exit;\r\n+}\r\n+$sql_adoptante = \"SELECT * FROM adoptante WHERE Correo = '$correo'\";\r\n+$resultado_adoptante = mysqli_query($conn, $sql_adoptante);\r\n+\r\n+if (mysqli_num_rows($resultado_adoptante) > 0) {\r\n+    $fila = mysqli_fetch_assoc($resultado_adoptante);\r\n+\r\n+    if (password_verify($contrasena, $fila['Contraseña'])) {\r\n+        $_SESSION['usuario'] = $fila['Nombre'];\r\n+        $_SESSION['rol'] = 'refugio';\r\n+        header(\"Location: Home_Petlover.html\");\r\n+        exit;\r\n+    } else {\r\n+        echo \"Contraseña incorrecta.\";\r\n+        exit;\r\n+    }\r\n+}\r\n+echo \"Correo no encontrado.\";\r\n+?>\r\n"
                },
                {
                    "date": 1743000892509,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,125 +1,89 @@\n <?php\r\n-session_start();\r\n-include('conexion.php');\r\n+ini_set('display_errors', 1);\r\n \r\n-if (!$conn) {\r\n-    die(\"Conexion fallida: \" . mysqli_connect_error());\r\n+ini_set('display_startup_errors', 1);\r\n+\r\n+error_reporting(E_ALL);\r\n+$opciones = [PDO::MYSQL_ATTR_INIT_COMMAND => \"SET NAMES utf8\"];\r\n+try {\r\n+    $db = new PDO('mysql:host=localhost;dbname=protectora', 'petlove', 'mascota');\r\n+    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\r\n+}catch (PDOException $e){\r\n+    echo 'Falló la conixion: ' . $e->getMessage(); \r\n }\r\n+/*session_start();\r\n+$servername = 'localhost'; // este sera el nombre de nuestro servidor\r\n+$database = 'protectora'; // nombre bd\r\n+$username = 'petlove'; // Usuario bd\r\n+$password = 'mascota'; // pass base de datos\r\n+$conn = new mysqli($servername, $username, $password, $database);\r\n+if ($conn->connect_errno){\r\n+    echo 'fallo al conectar';\r\n+    die(\"Conexion fallida: \". $conn->connect_error);\r\n+}*/\r\n $correo = trim($_POST['email']);\r\n $contrasena = trim($_POST['password']);\r\n-\r\n if (empty($correo) || empty($contrasena)) {\r\n     echo \"Por favor completa todos los campos.\";\r\n     exit;\r\n }\r\n-$sql_adoptante = \"SELECT * FROM adoptante WHERE Correo = '$correo'\";\r\n-$resultado_adoptante = mysqli_query($conn, $sql_adoptante);\r\n+$registros_adoptante = $db->execute(\"SELECT * FROM adoptante WHERE Correo = '$correo'\");\r\n+//$sql_adoptante = \"SELECT * FROM adoptante WHERE Correo = '$correo'\";\r\n+//$resultado_adoptante = mysqli_query($conn, $sql_adoptante);\r\n+//if (mysqli_num_rows($resultado_adoptante) > 0) {\r\n+   if ($registros_adoptante->rowCount() > 0) {\r\n+    $fila = $registros_adoptante->fetch(PDO::FETCH_ASSOC);\r\n+    if (password_verify($contrasena, $fila['Contraseña'])) {\r\n \r\n-if (mysqli_num_rows($resultado_adoptante) > 0) {\r\n-    $fila = mysqli_fetch_assoc($resultado_adoptante);\r\n+        //setcookie(\"tipo_usuario\", \"adoptante\", time() + (86400 * 30), \"/\");\r\n \r\n-    if (password_verify($contrasena, $fila['Contraseña'])) {\r\n-        $_SESSION['usuario'] = $fila['Nombre'];\r\n-        $_SESSION['rol'] = 'refugio';\r\n-        header(\"Location: Home_Petlover.html\");\r\n-        exit;\r\n+        //$_SESSION['usuario'] = $fila['Nombre'];\r\n+        //$_SESSION['rol'] = 'refugio';\r\n+        echo '<!DOCTYPE html>\r\n+            <html lang=\"es\">\r\n+                <head>\r\n+                    <meta charset=\"UTF-8\">\r\n+                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n+                    <title>Registro Exitoso</title>\r\n+                </head>\r\n+                <body class=\"cuerpo\">\r\n+                    <div class=\"alertas\">\r\n+                        <h1>Inicio de sesion exitoso</h1>\r\n+                        <a href=\"/Paginas_web/Home_Petlover.html\"> Ir al inicio</a>\r\n+                    </div>\r\n+                </body>\r\n+            </html>\r\n+            ';\r\n+            exit;\r\n     } else {\r\n         echo \"Contraseña incorrecta.\";\r\n         exit;\r\n     }\r\n }\r\n-echo \"Correo no encontrado.\";\r\n-?>\r\n-<?php\r\n-session_start();\r\n-include('conexion.php');\r\n-\r\n-if (!$conn) {\r\n-    die(\"Conexion fallida: \" . mysqli_connect_error());\r\n-}\r\n-$correo = trim($_POST['correo']);\r\n-$contrasena = trim($_POST['contrasena']);\r\n-\r\n-if (empty($correo) || empty($contrasena)) {\r\n-    echo \"Por favor completa todos los campos.\";\r\n-    exit;\r\n-}\r\n-$sql_adoptante = \"SELECT * FROM adoptante WHERE Correo = '$correo'\";\r\n-$resultado_adoptante = mysqli_query($conn, $sql_adoptante);\r\n-\r\n-if (mysqli_num_rows($resultado_adoptante) > 0) {\r\n-    $fila = mysqli_fetch_assoc($resultado_adoptante);\r\n-\r\n+$registros_protectora = $db->execute(\"SELECT * FROM refugio WHERE Correo = '$correo'\");\r\n+   if ($registros_protectora->rowCount() > 0) {\r\n+    $fila = $registros_protectora->fetch(PDO::FETCH_ASSOC);\r\n     if (password_verify($contrasena, $fila['Contraseña'])) {\r\n-        $_SESSION['usuario'] = $fila['Nombre'];\r\n-        $_SESSION['rol'] = 'refugio';\r\n-        header(\"Location: Home_Petlover.html\");\r\n-        exit;\r\n+        echo '<!DOCTYPE html>\r\n+            <html lang=\"es\">\r\n+                <head>\r\n+                    <meta charset=\"UTF-8\">\r\n+                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n+                    <title>Registro Exitoso</title>\r\n+                </head>\r\n+                <body class=\"cuerpo\">\r\n+                    <div class=\"alertas\">\r\n+                        <h1>Inicio de sesion exitoso</h1>\r\n+                        <a href=\"/Paginas_web/Home_Petlover.html\"> Ir al inicio</a>\r\n+                    </div>\r\n+                </body>\r\n+            </html>\r\n+            ';\r\n+            exit;\r\n     } else {\r\n         echo \"Contraseña incorrecta.\";\r\n         exit;\r\n\\ No newline at end of file\n     }\r\n }\r\n-\r\n echo \"Correo no encontrado.\";\r\n ?>\r\n-<?php\r\n-session_start();\r\n-include('conexion.php');\r\n-\r\n-if (!$conn) {\r\n-    die(\"Conexion fallida: \" . mysqli_connect_error());\r\n-}\r\n-$correo = trim($_POST['correo']);\r\n-$contrasena = trim($_POST['contrasena']);\r\n-\r\n-if (empty($correo) || empty($contrasena)) {\r\n-    echo \"Por favor completa todos los campos.\";\r\n-    exit;\r\n-}\r\n-$sql_adoptante = \"SELECT * FROM adoptante WHERE Correo = '$correo'\";\r\n-$resultado_adoptante = mysqli_query($conn, $sql_adoptante);\r\n-\r\n-if (mysqli_num_rows($resultado_adoptante) > 0) {\r\n-    $fila = mysqli_fetch_assoc($resultado_adoptante);\r\n-\r\n-    if (password_verify($contrasena, $fila['Contraseña'])) {\r\n-        $_SESSION['usuario'] = $fila['Nombre'];\r\n-        $_SESSION['rol'] = 'refugio';\r\n-        header(\"Location: Home_Petlover.html\");\r\n-        exit;\r\n-}\r\n-?>\n-<?php\r\n-session_start();\r\n-include('conexion.php');\r\n-\r\n-if (!$conn) {\r\n-    die(\"Conexion fallida: \" . mysqli_connect_error());\r\n-}\r\n-$correo = trim($_POST['correo']);\r\n-$contrasena = trim($_POST['contrasena']);\r\n-\r\n-if (empty($correo) || empty($contrasena)) {\r\n-    echo \"Por favor completa todos los campos.\";\r\n-    exit;\r\n-}\r\n-$sql_adoptante = \"SELECT * FROM adoptante WHERE Correo = '$correo'\";\r\n-$resultado_adoptante = mysqli_query($conn, $sql_adoptante);\r\n-\r\n-?>\n-<?php\r\n-session_start();\r\n-include('conexion.php');\r\n-\r\n-if (!$conn) {\r\n-    die(\"Conexion fallida: \" . mysqli_connect_error());\r\n-}\r\n-$correo = trim($_POST['correo']);\r\n-$contrasena = trim($_POST['contrasena']);\r\n-\r\n-if (empty($correo) || empty($contrasena)) {\r\n-    echo \"Por favor completa todos los campos.\";\r\n-    exit;\r\n-}\r\n-?>\n"
                },
                {
                    "date": 1747347496338,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,43 +3,36 @@\n \r\n ini_set('display_startup_errors', 1);\r\n \r\n error_reporting(E_ALL);\r\n+//Codificación UTF-8\r\n $opciones = [PDO::MYSQL_ATTR_INIT_COMMAND => \"SET NAMES utf8\"];\r\n try {\r\n     $db = new PDO('mysql:host=localhost;dbname=protectora', 'petlove', 'mascota');\r\n     $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\r\n }catch (PDOException $e){\r\n-    echo 'Falló la conixion: ' . $e->getMessage(); \r\n+    echo 'Falló la conexión: ' . $e->getMessage(); \r\n }\r\n-/*session_start();\r\n-$servername = 'localhost'; // este sera el nombre de nuestro servidor\r\n-$database = 'protectora'; // nombre bd\r\n-$username = 'petlove'; // Usuario bd\r\n-$password = 'mascota'; // pass base de datos\r\n-$conn = new mysqli($servername, $username, $password, $database);\r\n-if ($conn->connect_errno){\r\n-    echo 'fallo al conectar';\r\n-    die(\"Conexion fallida: \". $conn->connect_error);\r\n-}*/\r\n+// Recolectar y limpiar datos del formulario\r\n $correo = trim($_POST['email']);\r\n $contrasena = trim($_POST['password']);\r\n+// Validar campos obligatorios\r\n if (empty($correo) || empty($contrasena)) {\r\n-    echo \"Por favor completa todos los campos.\";\r\n+    echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n+    <div class='error'>Por favor completa todos los campos.</div>\";\r\n     exit;\r\n }\r\n-$registros_adoptante = $db->execute(\"SELECT * FROM adoptante WHERE Correo = '$correo'\");\r\n-//$sql_adoptante = \"SELECT * FROM adoptante WHERE Correo = '$correo'\";\r\n-//$resultado_adoptante = mysqli_query($conn, $sql_adoptante);\r\n-//if (mysqli_num_rows($resultado_adoptante) > 0) {\r\n+// Verificar si el usuario es adoptante\r\n+$registros_adoptante = $db->prepare(\"SELECT * FROM Adoptante WHERE Correo = :correo\");\r\n+$registros_adoptante ->bindParam(':correo', $correo);\r\n+$registros_adoptante ->execute();\r\n+\r\n    if ($registros_adoptante->rowCount() > 0) {\r\n     $fila = $registros_adoptante->fetch(PDO::FETCH_ASSOC);\r\n     if (password_verify($contrasena, $fila['Contraseña'])) {\r\n-\r\n         //setcookie(\"tipo_usuario\", \"adoptante\", time() + (86400 * 30), \"/\");\r\n-\r\n-        //$_SESSION['usuario'] = $fila['Nombre'];\r\n-        //$_SESSION['rol'] = 'refugio';\r\n+        setcookie(\"rol\", \"adoptante\", time() + (3600), \"/\");\r\n+        setcookie(\"nombre\",$nombre, time() + (3600), \"/\"); \r\n         echo '<!DOCTYPE html>\r\n             <html lang=\"es\">\r\n                 <head>\r\n                     <meta charset=\"UTF-8\">\r\n@@ -48,23 +41,31 @@\n                 </head>\r\n                 <body class=\"cuerpo\">\r\n                     <div class=\"alertas\">\r\n                         <h1>Inicio de sesion exitoso</h1>\r\n-                        <a href=\"/Paginas_web/Home_Petlover.html\"> Ir al inicio</a>\r\n+                        <a href=\"Home_Petlover.php\"> Ir al inicio</a>\r\n                     </div>\r\n                 </body>\r\n             </html>\r\n             ';\r\n             exit;\r\n     } else {\r\n-        echo \"Contraseña incorrecta.\";\r\n+        echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n+    <div class='error'>Contraseña incorrecta.</div\";\r\n         exit;\r\n     }\r\n }\r\n-$registros_protectora = $db->execute(\"SELECT * FROM refugio WHERE Correo = '$correo'\");\r\n-   if ($registros_protectora->rowCount() > 0) {\r\n+// Verificar si el usuario es una protectora\r\n+$registros_protectora = $db->prepare(\"SELECT * FROM Refugio WHERE Correo = :correo\");\r\n+$registros_protectora ->bindParam(':correo', $correo);\r\n+$registros_protectora ->execute();\r\n+if ($registros_protectora->rowCount() > 0) {\r\n     $fila = $registros_protectora->fetch(PDO::FETCH_ASSOC);\r\n     if (password_verify($contrasena, $fila['Contraseña'])) {\r\n+        $nombre= $fila['Nombre'];\r\n+        // Sesión para protectora\r\n+        setcookie(\"rol\", \"protectora\", time() + (3600), \"/\");\r\n+        setcookie(\"nombre\",$nombre, time() + (3600), \"/\"); \r\n         echo '<!DOCTYPE html>\r\n             <html lang=\"es\">\r\n                 <head>\r\n                     <meta charset=\"UTF-8\">\r\n@@ -80,10 +81,12 @@\n             </html>\r\n             ';\r\n             exit;\r\n     } else {\r\n-        echo \"Contraseña incorrecta.\";\r\n+        echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n+    <div class='error'>Contraseña incorrecta.</div>\";\r\n         exit;\r\n     }\r\n }\r\n\\ No newline at end of file\n-echo \"Correo no encontrado.\";\r\n-?>\n+echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n+    <div class='error'>Correo no encontrado.</div>\";\r\n+?>\r\n"
                },
                {
                    "date": 1747347564537,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,92 @@\n+<?php\r\n+ini_set('display_errors', 1);\r\n+\r\n+ini_set('display_startup_errors', 1);\r\n+\r\n+error_reporting(E_ALL);\r\n+//Codificación UTF-8\r\n+$opciones = [PDO::MYSQL_ATTR_INIT_COMMAND => \"SET NAMES utf8\"];\r\n+try {\r\n+    $db = new PDO('mysql:host=localhost;dbname=protectora', 'petlove', 'mascota');\r\n+    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\r\n+}catch (PDOException $e){\r\n+    echo 'Falló la conexión: ' . $e->getMessage(); \r\n+}\r\n+// Recolectar y limpiar datos del formulario\r\n+$correo = trim($_POST['email']);\r\n+$contrasena = trim($_POST['password']);\r\n+// Validar campos obligatorios\r\n+if (empty($correo) || empty($contrasena)) {\r\n+    echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n+    <div class='error'>Por favor completa todos los campos.</div>\";\r\n+    exit;\r\n+}\r\n+// Verificar si el usuario es adoptante\r\n+$registros_adoptante = $db->prepare(\"SELECT * FROM Adoptante WHERE Correo = :correo\");\r\n+$registros_adoptante ->bindParam(':correo', $correo);\r\n+$registros_adoptante ->execute();\r\n+\r\n+   if ($registros_adoptante->rowCount() > 0) {\r\n+    $fila = $registros_adoptante->fetch(PDO::FETCH_ASSOC);\r\n+    if (password_verify($contrasena, $fila['Contraseña'])) {\r\n+        //setcookie(\"tipo_usuario\", \"adoptante\", time() + (86400 * 30), \"/\");\r\n+        setcookie(\"rol\", \"adoptante\", time() + (3600), \"/\");\r\n+        setcookie(\"nombre\",$nombre, time() + (3600), \"/\"); \r\n+        echo '<!DOCTYPE html>\r\n+            <html lang=\"es\">\r\n+                <head>\r\n+                    <meta charset=\"UTF-8\">\r\n+                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n+                    <title>Registro Exitoso</title>\r\n+                </head>\r\n+                <body class=\"cuerpo\">\r\n+                    <div class=\"alertas\">\r\n+                        <h1>Inicio de sesion exitoso</h1>\r\n+                        <a href=\"Home_Petlover.php\"> Ir al inicio</a>\r\n+                    </div>\r\n+                </body>\r\n+            </html>\r\n+            ';\r\n+            exit;\r\n+    } else {\r\n+        echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n+    <div class='error'>Contraseña incorrecta.</div\";\r\n+        exit;\r\n+    }\r\n+}\r\n+// Verificar si el usuario es una protectora\r\n+$registros_protectora = $db->prepare(\"SELECT * FROM Refugio WHERE Correo = :correo\");\r\n+$registros_protectora ->bindParam(':correo', $correo);\r\n+$registros_protectora ->execute();\r\n+if ($registros_protectora->rowCount() > 0) {\r\n+    $fila = $registros_protectora->fetch(PDO::FETCH_ASSOC);\r\n+    if (password_verify($contrasena, $fila['Contraseña'])) {\r\n+        $nombre= $fila['Nombre'];\r\n+        // Sesión para protectora\r\n+        setcookie(\"rol\", \"protectora\", time() + (3600), \"/\");\r\n+        setcookie(\"nombre\",$nombre, time() + (3600), \"/\"); \r\n+        echo '<!DOCTYPE html>\r\n+            <html lang=\"es\">\r\n+                <head>\r\n+                    <meta charset=\"UTF-8\">\r\n+                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n+                    <title>Registro Exitoso</title>\r\n+                </head>\r\n+                <body class=\"cuerpo\">\r\n+                    <div class=\"alertas\">\r\n+                        <h1>Inicio de sesion exitoso</h1>\r\n+                        <a href=\"/Paginas_web/Home_Petlover.html\"> Ir al inicio</a>\r\n+                    </div>\r\n+                </body>\r\n+            </html>\r\n+            ';\r\n+            exit;\r\n+    } else {\r\n+        echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n+    <div class='error'>Contraseña incorrecta.</div>\";\r\n+        exit;\r\n+    }\r\n+}\r\n+echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n+    <div class='error'>Correo no encontrado.</div>\";\r\n+?>\r\n"
                },
                {
                    "date": 1747347586070,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -29,8 +29,9 @@\n    if ($registros_adoptante->rowCount() > 0) {\r\n     $fila = $registros_adoptante->fetch(PDO::FETCH_ASSOC);\r\n     if (password_verify($contrasena, $fila['Contraseña'])) {\r\n         //setcookie(\"tipo_usuario\", \"adoptante\", time() + (86400 * 30), \"/\");\r\n+         $nombre= $fila['Nombre'];\r\n         setcookie(\"rol\", \"adoptante\", time() + (3600), \"/\");\r\n         setcookie(\"nombre\",$nombre, time() + (3600), \"/\"); \r\n         echo '<!DOCTYPE html>\r\n             <html lang=\"es\">\r\n"
                },
                {
                    "date": 1747347645637,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,93 @@\n+<?php\r\n+ini_set('display_errors', 1);\r\n+\r\n+ini_set('display_startup_errors', 1);\r\n+\r\n+error_reporting(E_ALL);\r\n+//Codificación UTF-8\r\n+$opciones = [PDO::MYSQL_ATTR_INIT_COMMAND => \"SET NAMES utf8\"];\r\n+try {\r\n+    $db = new PDO('mysql:host=localhost;dbname=protectora', 'petlove', 'mascota');\r\n+    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\r\n+}catch (PDOException $e){\r\n+    echo 'Falló la conexión: ' . $e->getMessage(); \r\n+}\r\n+// Recolectar y limpiar datos del formulario\r\n+$correo = trim($_POST['email']);\r\n+$contrasena = trim($_POST['password']);\r\n+// Validar campos obligatorios\r\n+if (empty($correo) || empty($contrasena)) {\r\n+    echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n+    <div class='error'>Por favor completa todos los campos.</div>\";\r\n+    exit;\r\n+}\r\n+// Verificar si el usuario es adoptante\r\n+$registros_adoptante = $db->prepare(\"SELECT * FROM Adoptante WHERE Correo = :correo\");\r\n+$registros_adoptante ->bindParam(':correo', $correo);\r\n+$registros_adoptante ->execute();\r\n+\r\n+   if ($registros_adoptante->rowCount() > 0) {\r\n+    $fila = $registros_adoptante->fetch(PDO::FETCH_ASSOC);\r\n+    if (password_verify($contrasena, $fila['Contraseña'])) {\r\n+       // Sesión para adoptante\r\n+         $nombre= $fila['Nombre'];\r\n+        setcookie(\"rol\", \"adoptante\", time() + (3600), \"/\");\r\n+        setcookie(\"nombre\",$nombre, time() + (3600), \"/\"); \r\n+        echo '<!DOCTYPE html>\r\n+            <html lang=\"es\">\r\n+                <head>\r\n+                    <meta charset=\"UTF-8\">\r\n+                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n+                    <title>Registro Exitoso</title>\r\n+                </head>\r\n+                <body class=\"cuerpo\">\r\n+                    <div class=\"alertas\">\r\n+                        <h1>Inicio de sesion exitoso</h1>\r\n+                        <a href=\"Home_Petlover.php\"> Ir al inicio</a>\r\n+                    </div>\r\n+                </body>\r\n+            </html>\r\n+            ';\r\n+            exit;\r\n+    } else {\r\n+        echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n+    <div class='error'>Contraseña incorrecta.</div\";\r\n+        exit;\r\n+    }\r\n+}\r\n+// Verificar si el usuario es una protectora\r\n+$registros_protectora = $db->prepare(\"SELECT * FROM Refugio WHERE Correo = :correo\");\r\n+$registros_protectora ->bindParam(':correo', $correo);\r\n+$registros_protectora ->execute();\r\n+if ($registros_protectora->rowCount() > 0) {\r\n+    $fila = $registros_protectora->fetch(PDO::FETCH_ASSOC);\r\n+    if (password_verify($contrasena, $fila['Contraseña'])) {\r\n+        $nombre= $fila['Nombre'];\r\n+        // Sesión para protectora\r\n+        setcookie(\"rol\", \"protectora\", time() + (3600), \"/\");\r\n+        setcookie(\"nombre\",$nombre, time() + (3600), \"/\"); \r\n+        echo '<!DOCTYPE html>\r\n+            <html lang=\"es\">\r\n+                <head>\r\n+                    <meta charset=\"UTF-8\">\r\n+                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n+                    <title>Registro Exitoso</title>\r\n+                </head>\r\n+                <body class=\"cuerpo\">\r\n+                    <div class=\"alertas\">\r\n+                        <h1>Inicio de sesión exitoso</h1>\r\n+                        <a href=\"/Paginas_web/Home_Petlover.html\"> Ir al inicio</a>\r\n+                    </div>\r\n+                </body>\r\n+            </html>\r\n+            ';\r\n+            exit;\r\n+    } else {\r\n+        echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n+    <div class='error'>Contraseña incorrecta.</div>\";\r\n+        exit;\r\n+    }\r\n+}\r\n+echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n+    <div class='error'>Correo no encontrado.</div>\";\r\n+?>\r\n"
                },
                {
                    "date": 1747416159600,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,8 +37,9 @@\n             <html lang=\"es\">\r\n                 <head>\r\n                     <meta charset=\"UTF-8\">\r\n                     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n+                     <link rel=\"stylesheet\" href=\"./Css_Paginas/alertas_adopcion.css\">\r\n                     <title>Registro Exitoso</title>\r\n                 </head>\r\n                 <body class=\"cuerpo\">\r\n                     <div class=\"alertas\">\r\n@@ -70,8 +71,9 @@\n             <html lang=\"es\">\r\n                 <head>\r\n                     <meta charset=\"UTF-8\">\r\n                     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n+                    \r\n                     <title>Registro Exitoso</title>\r\n                 </head>\r\n                 <body class=\"cuerpo\">\r\n                     <div class=\"alertas\">\r\n@@ -90,189 +92,4 @@\n }\r\n echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n     <div class='error'>Correo no encontrado.</div>\";\r\n ?>\r\n-<?php\r\n-ini_set('display_errors', 1);\r\n-\r\n-ini_set('display_startup_errors', 1);\r\n-\r\n-error_reporting(E_ALL);\r\n-//Codificación UTF-8\r\n-$opciones = [PDO::MYSQL_ATTR_INIT_COMMAND => \"SET NAMES utf8\"];\r\n-try {\r\n-    $db = new PDO('mysql:host=localhost;dbname=protectora', 'petlove', 'mascota');\r\n-    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\r\n-}catch (PDOException $e){\r\n-    echo 'Falló la conexión: ' . $e->getMessage(); \r\n-}\r\n-// Recolectar y limpiar datos del formulario\r\n-$correo = trim($_POST['email']);\r\n-$contrasena = trim($_POST['password']);\r\n-// Validar campos obligatorios\r\n-if (empty($correo) || empty($contrasena)) {\r\n-    echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n-    <div class='error'>Por favor completa todos los campos.</div>\";\r\n-    exit;\r\n-}\r\n-// Verificar si el usuario es adoptante\r\n-$registros_adoptante = $db->prepare(\"SELECT * FROM Adoptante WHERE Correo = :correo\");\r\n-$registros_adoptante ->bindParam(':correo', $correo);\r\n-$registros_adoptante ->execute();\r\n-\r\n-   if ($registros_adoptante->rowCount() > 0) {\r\n-    $fila = $registros_adoptante->fetch(PDO::FETCH_ASSOC);\r\n-    if (password_verify($contrasena, $fila['Contraseña'])) {\r\n-        //setcookie(\"tipo_usuario\", \"adoptante\", time() + (86400 * 30), \"/\");\r\n-         $nombre= $fila['Nombre'];\r\n-        setcookie(\"rol\", \"adoptante\", time() + (3600), \"/\");\r\n-        setcookie(\"nombre\",$nombre, time() + (3600), \"/\"); \r\n-        echo '<!DOCTYPE html>\r\n-            <html lang=\"es\">\r\n-                <head>\r\n-                    <meta charset=\"UTF-8\">\r\n-                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n-                    <title>Registro Exitoso</title>\r\n-                </head>\r\n-                <body class=\"cuerpo\">\r\n-                    <div class=\"alertas\">\r\n-                        <h1>Inicio de sesion exitoso</h1>\r\n-                        <a href=\"Home_Petlover.php\"> Ir al inicio</a>\r\n-                    </div>\r\n-                </body>\r\n-            </html>\r\n-            ';\r\n-            exit;\r\n-    } else {\r\n-        echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n-    <div class='error'>Contraseña incorrecta.</div\";\r\n-        exit;\r\n-    }\r\n-}\r\n-// Verificar si el usuario es una protectora\r\n-$registros_protectora = $db->prepare(\"SELECT * FROM Refugio WHERE Correo = :correo\");\r\n-$registros_protectora ->bindParam(':correo', $correo);\r\n-$registros_protectora ->execute();\r\n-if ($registros_protectora->rowCount() > 0) {\r\n-    $fila = $registros_protectora->fetch(PDO::FETCH_ASSOC);\r\n-    if (password_verify($contrasena, $fila['Contraseña'])) {\r\n-        $nombre= $fila['Nombre'];\r\n-        // Sesión para protectora\r\n-        setcookie(\"rol\", \"protectora\", time() + (3600), \"/\");\r\n-        setcookie(\"nombre\",$nombre, time() + (3600), \"/\"); \r\n-        echo '<!DOCTYPE html>\r\n-            <html lang=\"es\">\r\n-                <head>\r\n-                    <meta charset=\"UTF-8\">\r\n-                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n-                    <title>Registro Exitoso</title>\r\n-                </head>\r\n-                <body class=\"cuerpo\">\r\n-                    <div class=\"alertas\">\r\n-                        <h1>Inicio de sesion exitoso</h1>\r\n-                        <a href=\"/Paginas_web/Home_Petlover.html\"> Ir al inicio</a>\r\n-                    </div>\r\n-                </body>\r\n-            </html>\r\n-            ';\r\n-            exit;\r\n-    } else {\r\n-        echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n-    <div class='error'>Contraseña incorrecta.</div>\";\r\n-        exit;\r\n-    }\r\n-}\r\n-echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n-    <div class='error'>Correo no encontrado.</div>\";\r\n-?>\r\n-<?php\r\n-ini_set('display_errors', 1);\r\n-\r\n-ini_set('display_startup_errors', 1);\r\n-\r\n-error_reporting(E_ALL);\r\n-//Codificación UTF-8\r\n-$opciones = [PDO::MYSQL_ATTR_INIT_COMMAND => \"SET NAMES utf8\"];\r\n-try {\r\n-    $db = new PDO('mysql:host=localhost;dbname=protectora', 'petlove', 'mascota');\r\n-    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\r\n-}catch (PDOException $e){\r\n-    echo 'Falló la conexión: ' . $e->getMessage(); \r\n-}\r\n-// Recolectar y limpiar datos del formulario\r\n-$correo = trim($_POST['email']);\r\n-$contrasena = trim($_POST['password']);\r\n-// Validar campos obligatorios\r\n-if (empty($correo) || empty($contrasena)) {\r\n-    echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n-    <div class='error'>Por favor completa todos los campos.</div>\";\r\n-    exit;\r\n-}\r\n-// Verificar si el usuario es adoptante\r\n-$registros_adoptante = $db->prepare(\"SELECT * FROM Adoptante WHERE Correo = :correo\");\r\n-$registros_adoptante ->bindParam(':correo', $correo);\r\n-$registros_adoptante ->execute();\r\n-\r\n-   if ($registros_adoptante->rowCount() > 0) {\r\n-    $fila = $registros_adoptante->fetch(PDO::FETCH_ASSOC);\r\n-    if (password_verify($contrasena, $fila['Contraseña'])) {\r\n-        //setcookie(\"tipo_usuario\", \"adoptante\", time() + (86400 * 30), \"/\");\r\n-        setcookie(\"rol\", \"adoptante\", time() + (3600), \"/\");\r\n-        setcookie(\"nombre\",$nombre, time() + (3600), \"/\"); \r\n-        echo '<!DOCTYPE html>\r\n-            <html lang=\"es\">\r\n-                <head>\r\n-                    <meta charset=\"UTF-8\">\r\n-                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n-                    <title>Registro Exitoso</title>\r\n-                </head>\r\n-                <body class=\"cuerpo\">\r\n-                    <div class=\"alertas\">\r\n-                        <h1>Inicio de sesion exitoso</h1>\r\n-                        <a href=\"Home_Petlover.php\"> Ir al inicio</a>\r\n-                    </div>\r\n-                </body>\r\n-            </html>\r\n-            ';\r\n-            exit;\r\n-    } else {\r\n-        echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n-    <div class='error'>Contraseña incorrecta.</div\";\r\n-        exit;\r\n-    }\r\n-}\r\n-// Verificar si el usuario es una protectora\r\n-$registros_protectora = $db->prepare(\"SELECT * FROM Refugio WHERE Correo = :correo\");\r\n-$registros_protectora ->bindParam(':correo', $correo);\r\n-$registros_protectora ->execute();\r\n-if ($registros_protectora->rowCount() > 0) {\r\n-    $fila = $registros_protectora->fetch(PDO::FETCH_ASSOC);\r\n-    if (password_verify($contrasena, $fila['Contraseña'])) {\r\n-        $nombre= $fila['Nombre'];\r\n-        // Sesión para protectora\r\n-        setcookie(\"rol\", \"protectora\", time() + (3600), \"/\");\r\n-        setcookie(\"nombre\",$nombre, time() + (3600), \"/\"); \r\n-        echo '<!DOCTYPE html>\r\n-            <html lang=\"es\">\r\n-                <head>\r\n-                    <meta charset=\"UTF-8\">\r\n-                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n-                    <title>Registro Exitoso</title>\r\n-                </head>\r\n-                <body class=\"cuerpo\">\r\n-                    <div class=\"alertas\">\r\n-                        <h1>Inicio de sesion exitoso</h1>\r\n-                        <a href=\"/Paginas_web/Home_Petlover.html\"> Ir al inicio</a>\r\n-                    </div>\r\n-                </body>\r\n-            </html>\r\n-            ';\r\n-            exit;\r\n-    } else {\r\n-        echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n-    <div class='error'>Contraseña incorrecta.</div>\";\r\n-        exit;\r\n-    }\r\n-}\r\n-echo \"<link rel='stylesheet' href='./Css_Paginas/Errores.css'>\r\n-    <div class='error'>Correo no encontrado.</div>\";\r\n-?>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1747416169098,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,8 +70,9 @@\n         echo '<!DOCTYPE html>\r\n             <html lang=\"es\">\r\n                 <head>\r\n                     <meta charset=\"UTF-8\">\r\n+                     <link rel=\"stylesheet\" href=\"./Css_Paginas/alertas_adopcion.css\">\r\n                     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n                     \r\n                     <title>Registro Exitoso</title>\r\n                 </head>\r\n"
                }
            ],
            "date": 1741794668563,
            "name": "Commit-0",
            "content": "<?php\r\nsession_start();\r\ninclude('conexion.php');\r\n\r\nif (!$conn) {\r\n    die(\"Error de conexión: \" . mysqli_connect_error());\r\n?>"
        }
    ]
}