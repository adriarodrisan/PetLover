{
    "sourceFile": "Paginas_web/insertar_datos_registro.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1741190279828,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1741794418623,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,22 +21,22 @@\n }\r\n //verificar si el mail esta registrado\r\n $verificar_correo_usuario = \"SELECT * FROM adoptante WHERE Correo = '$correo'\";\r\n $correo_verificado_usuario = mysqli_query($conn, $verificar_correo_usuario);\r\n-if (mysqli_num_rows($correo_verificado)>0){\r\n+if (mysqli_num_rows($correo_verificado_usuario)>0){\r\n     echo \"Este correo ya esta registrado, por favor, intelo con otro correo\";\r\n     exit;\r\n }\r\n $verificar_correo_protectora = \"SELECT * FROM refugio WHERE Correo = '$correo'\";\r\n $correo_verificado_protectora = mysqli_query($conn, $verificar_correo_protectora);\r\n-if (mysqli_num_rows($correo_verificado)>0){\r\n+if (mysqli_num_rows($correo_verificado_protectora)>0){\r\n     echo \"Este correo ya esta registrado, por favor, intelo con otro correo\";\r\n     exit;\r\n }\r\n //hashear pass\r\n-$contrasena_hasheada = password_hash($contrasena, PASSWORD_DEFAULT);\r\n+$contrasena_hasheada = password_hash($contrasena, PASSWORD_DEFAULT());\r\n $registrar_usuarios = \"INSERT INTO adoptante (DNI, Nombre, Telefono, Correo, Contraseña) VALUES ('$dni', '$nombre','$telefono','$correo','$contrasena_hasheada');\";\r\n-if (mysqli_query($conn, $registrar_usuario)){\r\n+if (mysqli_query($conn, $registrar_usuarios)){\r\n     echo '<!DOCTYPE html>\r\n             <html lang=\"es\">\r\n                 <head>\r\n                     <meta charset=\"UTF-8\">\r\n@@ -45,9 +45,9 @@\n                 </head>\r\n                 <body class=\"cuerpo\">\r\n                     <div class=\"alertas\">\r\n                         <h1>Registro Exitoso</h1>\r\n-                        <a href=\"/pagina_web/Home_Petlover.html> Ir al inicio</a>\r\n+                        <a href=\"/Paginas_web/Home_Petlover.html\"> Ir al inicio</a>\r\n                     </div>\r\n                 </body>\r\n             </html>\r\n             ';\r\n"
                }
            ],
            "date": 1741190279828,
            "name": "Commit-0",
            "content": "<?php\r\nrequire_once ('conexion.php');\r\nif (!$conn){\r\n    die(\"Conexión fallida: \". mysqli_connect_error());\r\n}\r\n$dni= trim($_POST['dni']);\r\n$nombre= trim($_POST['nombre']);\r\n$telefono= trim($_POST['telefono']);\r\n$correo= trim($_POST['correo']);\r\n$contrasena= trim($_POST['contrasena']);\r\n$confirmar_contrasena= trim($_POST['confirmar_contrasena']);\r\n//revisar que los campos no sean null\r\nif(empty($dni) || empty($nombre) || empty($telefono) || empty($correo) || empty($contrasena) || empty($confirmar_contrasena)){\r\n    echo \"Por favor, no dejes ningun hueco vacio en el formulario\";\r\n    exit;\r\n}\r\n//verificar las contraseñas que sean iguales\r\nif ($contrasena !== $confirmar_contrasena){\r\n    echo \"Las cotraseñas no coinciden.\";\r\n    exit;\r\n}\r\n//verificar si el mail esta registrado\r\n$verificar_correo_usuario = \"SELECT * FROM adoptante WHERE Correo = '$correo'\";\r\n$correo_verificado_usuario = mysqli_query($conn, $verificar_correo_usuario);\r\nif (mysqli_num_rows($correo_verificado)>0){\r\n    echo \"Este correo ya esta registrado, por favor, intelo con otro correo\";\r\n    exit;\r\n}\r\n$verificar_correo_protectora = \"SELECT * FROM refugio WHERE Correo = '$correo'\";\r\n$correo_verificado_protectora = mysqli_query($conn, $verificar_correo_protectora);\r\nif (mysqli_num_rows($correo_verificado)>0){\r\n    echo \"Este correo ya esta registrado, por favor, intelo con otro correo\";\r\n    exit;\r\n}\r\n//hashear pass\r\n$contrasena_hasheada = password_hash($contrasena, PASSWORD_DEFAULT);\r\n$registrar_usuarios = \"INSERT INTO adoptante (DNI, Nombre, Telefono, Correo, Contraseña) VALUES ('$dni', '$nombre','$telefono','$correo','$contrasena_hasheada');\";\r\nif (mysqli_query($conn, $registrar_usuario)){\r\n    echo '<!DOCTYPE html>\r\n            <html lang=\"es\">\r\n                <head>\r\n                    <meta charset=\"UTF-8\">\r\n                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n                    <title>Registro Exitoso</title>\r\n                </head>\r\n                <body class=\"cuerpo\">\r\n                    <div class=\"alertas\">\r\n                        <h1>Registro Exitoso</h1>\r\n                        <a href=\"/pagina_web/Home_Petlover.html> Ir al inicio</a>\r\n                    </div>\r\n                </body>\r\n            </html>\r\n            ';\r\n            exit;\r\n}else{\r\n    echo \"Error al registrar usuario: \". mysqli_error($conn);\r\n}\r\n?>"
        }
    ]
}